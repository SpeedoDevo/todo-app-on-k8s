apiVersion: skaffold/v2alpha4
kind: Config
build:
  tagPolicy:
    sha256: {}
  artifacts:
    - image: registry.gitlab.com/speedodevo/todo-app
      context: src/todo-service
deploy:
  helm:
    releases:
      - name: skaffold-todo-app
        chartPath: deploy/helm
        values:
          todo-service.image: registry.gitlab.com/speedodevo/todo-app
profiles:
  - name: run
    activation:
      - command: run
    patches:
      - op: add
        path: /deploy/helm/releases/0/setValues
        value:
          todo-service.serviceType: ClusterIP
